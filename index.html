<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Informe Consolidado de Laboratorio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 2rem 1rem;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .hero-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 4rem 2rem;
            position: relative;
            overflow: hidden;
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -10%;
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }

        .section-card {
            background: white;
            padding: 3rem;
            margin: 2rem;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
        }

        .problem-solution {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .card-danger {
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
            padding: 2rem;
            border-radius: 16px;
            border-left: 4px solid #ef4444;
            position: relative;
        }

        .card-success {
            background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
            padding: 2rem;
            border-radius: 16px;
            border-left: 4px solid #10b981;
            position: relative;
        }

        .data-table-container {
            overflow-x: auto;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            margin: 1.5rem 0;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        .data-table thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .data-table th {
            padding: 1rem;
            text-align: left;
            font-size: 0.75rem;
            font-weight: 700;
            color: white;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .data-table td {
            padding: 1rem;
            border-bottom: 1px solid #f3f4f6;
            font-size: 0.875rem;
            color: #374151;
        }

        .data-table tbody tr:hover {
            background: #f9fafb;
        }

        .data-table .highlight-row {
            background: linear-gradient(90deg, rgba(236, 72, 153, 0.1) 0%, rgba(236, 72, 153, 0.05) 100%);
            font-weight: 600;
        }

        .flow-box {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            position: relative;
            border: 2px solid #e5e7eb;
        }

        .flow-box.database {
            border-color: #3b82f6;
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
        }

        .flow-box.template {
            border-color: #f59e0b;
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
        }

        .flow-box.output {
            border-color: #10b981;
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
        }

        .arrow-down {
            display: flex;
            justify-content: center;
            margin: 1rem 0;
        }

        .arrow-down svg {
            color: #667eea;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(10px); }
        }

        .badge {
            display: inline-block;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 600;
            margin: 0.25rem;
        }

        .badge-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            padding: 1.5rem;
            border-radius: 12px;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            line-height: 1.8;
            overflow-x: auto;
            box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        .warning-box {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            padding: 1.5rem;
            border-radius: 12px;
            border-left: 4px solid #f59e0b;
            margin: 1.5rem 0;
        }

        .critical-box {
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
            padding: 1.5rem;
            border-radius: 12px;
            border-left: 4px solid #ef4444;
            margin: 1.5rem 0;
        }

        .info-box {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            padding: 1.5rem;
            border-radius: 12px;
            border-left: 4px solid #3b82f6;
            margin: 1.5rem 0;
        }

        .metric-card {
            background: linear-gradient(135deg, #f5f3ff 0%, #ede9fe 100%);
            padding: 2rem;
            border-radius: 16px;
            text-align: center;
            border: 2px solid #a78bfa;
        }

        .metric-value {
            font-size: 3rem;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .step-number {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.25rem;
            margin-bottom: 1rem;
        }

        @media (max-width: 768px) {
            .section-card {
                padding: 1.5rem;
                margin: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="glass-card">
            <!-- Hero Section -->
            <div class="hero-section">
                <div style="position: relative; z-index: 1; text-align: center;">
                    <div style="display: inline-block; background: rgba(255,255,255,0.2); padding: 0.5rem 1.5rem; border-radius: 20px; margin-bottom: 1rem;">
                        <span style="color: white; font-size: 0.875rem; font-weight: 600; letter-spacing: 0.05em;">SISTEMA DE LABORATORIO CL√çNICO</span>
                    </div>
                    <h1 style="font-size: 3.5rem; font-weight: 900; color: white; margin-bottom: 1rem; line-height: 1.2;">
                        Informe Consolidado Digital
                    </h1>
                    <p style="font-size: 1.25rem; color: rgba(255,255,255,0.9); max-width: 700px; margin: 0 auto;">
                        L√≥gica de Paginaci√≥n con Referencias Din√°micas en Plantilla
                    </p>
                </div>
            </div>

            <!-- Secci√≥n 1: Problema y Soluci√≥n -->
            <div class="section-card">
                <h2 style="font-size: 2rem; font-weight: 800; color: #1f2937; margin-bottom: 1rem;">
                    Situaci√≥n Actual y Objetivo Principal
                </h2>
                <p style="color: #6b7280; font-size: 1.125rem; margin-bottom: 2rem;">
                    Transformando la gesti√≥n documental del laboratorio
                </p>

                <div class="problem-solution">
                    <div class="card-danger">
                        <div style="width: 3rem; height: 3rem; background: rgba(239, 68, 68, 0.2); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem;">
                            <svg style="width: 1.5rem; height: 1.5rem; color: #dc2626;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M18 6L6 18M6 6l12 12"></path>
                            </svg>
                        </div>
                        <h3 style="font-size: 1.5rem; font-weight: 700; color: #dc2626; margin-bottom: 1rem;">
                            Problema Actual
                        </h3>
                        <p style="color: #7f1d1d; line-height: 1.6;">
                            Cada examen genera un PDF separado, resultando en <strong>m√∫ltiples archivos desorganizados</strong> para un mismo encuentro cl√≠nico.
                        </p>
                    </div>

                    <div class="card-success">
                        <div style="width: 3rem; height: 3rem; background: rgba(16, 185, 129, 0.2); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem;">
                            <svg style="width: 1.5rem; height: 1.5rem; color: #059669;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                                <polyline points="22 4 12 14.01 9 11.01"></polyline>
                            </svg>
                        </div>
                        <h3 style="font-size: 1.5rem; font-weight: 700; color: #059669; margin-bottom: 1rem;">
                            Soluci√≥n Implementada
                        </h3>
                        <p style="color: #14532d; line-height: 1.6;">
                            Consolidaci√≥n de todos los resultados en <strong>un √∫nico PDF</strong> con paginaci√≥n inteligente que considera el espacio de las plantillas de referencia.
                        </p>
                    </div>
                </div>
            </div>

            <!-- Secci√≥n 2: Flujo Completo -->
            <div class="section-card" style="background: linear-gradient(135deg, #faf5ff 0%, #f5f3ff 100%);">
                <h2 style="font-size: 2rem; font-weight: 800; color: #1f2937; margin-bottom: 0.5rem;">
                    Flujo Completo del Sistema
                </h2>
                <p style="color: #6b7280; margin-bottom: 3rem; font-size: 1.125rem;">De la base de datos al PDF consolidado</p>

                <!-- PASO 1: BASE DE DATOS -->
                <div class="flow-box database">
                    <div class="step-number">1</div>
                    <h3 style="font-size: 1.5rem; font-weight: 700; color: #1e40af; margin-bottom: 1.5rem;">
                        üìä DATOS EN BASE DE DATOS (Solo datos del paciente)
                    </h3>

                    <div style="background: white; padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem;">
                        <h4 style="font-weight: 600; color: #374151; margin-bottom: 1rem;">Tabla Maestra de Ex√°menes</h4>
                        <div class="data-table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Examen</th>
                                        <th>L√≠neas Totales*</th>
                                        <th>Campos de Datos</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><span class="badge badge-primary">1</span></td>
                                        <td><strong>GLUCOSA</strong></td>
                                        <td>4 l√≠neas</td>
                                        <td>valor, unidad</td>
                                    </tr>
                                    <tr>
                                        <td><span class="badge badge-primary">2</span></td>
                                        <td><strong>HEMOGRAMA</strong></td>
                                        <td>8 l√≠neas</td>
                                        <td>hematocrito, hemoglobina, leucocitos</td>
                                    </tr>
                                    <tr>
                                        <td><span class="badge badge-primary">3</span></td>
                                        <td><strong>UROCULTIVO</strong></td>
                                        <td>25 l√≠neas</td>
                                        <td>leucocitos, hemat√≠as, bacterias, microorganismo</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="warning-box">
                            <p style="color: #78350f; line-height: 1.6;">
                                <strong>*L√≠neas Totales incluye:</strong> T√≠tulo del examen + Datos del paciente + <strong>ESPACIO RESERVADO para valores de referencia</strong> (aunque NO se guardan en BD)
                            </p>
                        </div>
                    </div>

                    <div style="background: white; padding: 1.5rem; border-radius: 8px;">
                        <h4 style="font-weight: 600; color: #374151; margin-bottom: 1rem;">Tabla de Resultados (Solo valores del paciente)</h4>
                        <div class="data-table-container">
                            <table class="data-table">
                                <thead>
                                    <tr><th>ID</th><th>Orden</th><th>Examen</th><th>Valor 1</th><th>Valor 2</th><th>Valor 3</th></tr>
                                </thead>
                                <tbody>
                                    <tr><td>5001</td><td>1001</td><td>GLUCOSA</td><td>95</td><td>mg/dL</td><td>‚Äî</td></tr>
                                    <tr><td>5002</td><td>1001</td><td>HEMOGRAMA</td><td>42%</td><td>14 g/dL</td><td>6,500</td></tr>
                                    <tr><td>5003</td><td>1001</td><td>UROCULTIVO</td><td>5-8/Campo</td><td>0-1/Campo</td><td>ESCASOS</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="critical-box" style="margin-top: 1.5rem;">
                        <div style="display: flex; align-items: start; gap: 1rem;">
                            <svg style="width: 1.5rem; height: 1.5rem; color: #dc2626; flex-shrink: 0; margin-top: 0.25rem;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <line x1="12" y1="8" x2="12" y2="12"></line>
                                <line x1="12" y1="16" x2="12.01" y2="16"></line>
                            </svg>
                            <div>
                                <h5 style="font-weight: 700; color: #7f1d1d; margin-bottom: 0.5rem; font-size: 1.125rem;">PUNTO CR√çTICO</h5>
                                <p style="color: #7f1d1d; line-height: 1.7; font-weight: 500;">
                                    Los <strong>valores de referencia NO se guardan en la base de datos</strong>. Solo se almacenan los datos del paciente (95, 42%, 6,500, etc.)
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- FLECHA -->
                <div class="arrow-down">
                    <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <polyline points="19 12 12 19 5 12"></polyline>
                    </svg>
                </div>

                <!-- PASO 2: PLANTILLA -->
                <div class="flow-box template">
                    <div class="step-number" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);">2</div>
                    <h3 style="font-size: 1.5rem; font-weight: 700; color: #92400e; margin-bottom: 1.5rem;">
                        üìÑ PLANTILLA DE IMPRESI√ìN (Con referencias hardcodeadas)
                    </h3>

                    <div style="background: white; padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem;">
                        <h4 style="font-weight: 600; color: #374151; margin-bottom: 1rem;">Ejemplo: Plantilla de GLUCOSA (4 l√≠neas)</h4>
                        <div class="code-block">
<span style="color: #fbbf24;">‚îÅ‚îÅ‚îÅ GLUCOSA ‚îÅ‚îÅ‚îÅ</span>                           ‚Üê L√≠nea 1: T√≠tulo
  Resultado: <span style="color: #10b981;">[VALOR_PACIENTE]</span> <span style="color: #10b981;">[UNIDAD]</span>   ‚Üê L√≠nea 2: Dato de BD
  <span style="color: #f97316;">Valor de Referencia: 70-110 mg/dL</span>    ‚Üê L√≠nea 3: <strong>HARDCODEADO</strong>
                                             ‚Üê L√≠nea 4: Espacio
                        </div>
                    </div>

                    <div style="background: white; padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem;">
                        <h4 style="font-weight: 600; color: #374151; margin-bottom: 1rem;">Ejemplo: Plantilla de HEMOGRAMA (8 l√≠neas)</h4>
                        <div class="code-block">
<span style="color: #fbbf24;">‚îÅ‚îÅ‚îÅ HEMOGRAMA ‚îÅ‚îÅ‚îÅ</span>                        ‚Üê L√≠nea 1: T√≠tulo
  Hematocrito: <span style="color: #10b981;">[VALOR_1]</span>                ‚Üê L√≠nea 2: Dato de BD
  <span style="color: #f97316;">Referencia: 40-50%</span>                    ‚Üê L√≠nea 3: <strong>HARDCODEADO</strong>
  Hemoglobina: <span style="color: #10b981;">[VALOR_2]</span>                ‚Üê L√≠nea 4: Dato de BD
  <span style="color: #f97316;">Referencia: 12-16 g/dL</span>                ‚Üê L√≠nea 5: <strong>HARDCODEADO</strong>
  Leucocitos: <span style="color: #10b981;">[VALOR_3]</span>                 ‚Üê L√≠nea 6: Dato de BD
  <span style="color: #f97316;">Referencia: 4,000-11,000</span>              ‚Üê L√≠nea 7: <strong>HARDCODEADO</strong>
                                             ‚Üê L√≠nea 8: Espacio
                        </div>
                    </div>

                    <div class="info-box">
                        <div style="display: flex; align-items: start; gap: 1rem;">
                            <svg style="width: 1.5rem; height: 1.5rem; color: #1e40af; flex-shrink: 0; margin-top: 0.25rem;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <line x1="12" y1="16" x2="12" y2="12"></line>
                                <line x1="12" y1="8" x2="12.01" y2="8"></line>
                            </svg>
                            <div>
                                <h5 style="font-weight: 700; color: #1e3a8a; margin-bottom: 0.5rem;">¬øPor qu√© contar las l√≠neas de referencia?</h5>
                                <p style="color: #1e3a8a; line-height: 1.7;">
                                    Las referencias ocupan <strong>ESPACIO F√çSICO en el PDF</strong>. Si no las contamos en la l√≥gica de paginaci√≥n, los ex√°menes se solapar√≠an o se cortar√≠an entre p√°ginas.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- FLECHA -->
                <div class="arrow-down">
                    <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <polyline points="19 12 12 19 5 12"></polyline>
                    </svg>
                </div>

                <!-- PASO 3: C√ÅLCULO -->
                <div class="flow-box" style="border-color: #8b5cf6; background: linear-gradient(135deg, #f5f3ff 0%, #ede9fe 100%);">
                    <div class="step-number" style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);">3</div>
                    <h3 style="font-size: 1.5rem; font-weight: 700; color: #6b21a8; margin-bottom: 1.5rem;">
                        üßÆ C√ÅLCULO DE PAGINACI√ìN (M√°x. 22 l√≠neas/p√°gina)
                    </h3>

                    <div style="background: white; padding: 1.5rem; border-radius: 8px;">
                        <div class="data-table-container">
                            <table class="data-table">
                                <thead>
                                    <tr><th>Examen</th><th>L√≠neas Total</th><th>Separador</th><th>Acumulado</th><th>P√°gina</th><th>L√≥gica</th></tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>Glucosa</strong></td>
                                        <td>4</td>
                                        <td>1</td>
                                        <td>5</td>
                                        <td>1</td>
                                        <td style="font-size: 0.75rem; color: #6b7280;">5 ‚â§ 22 ‚úì Cabe</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Hemograma</strong></td>
                                        <td>8</td>
                                        <td>1</td>
                                        <td>14</td>
                                        <td>1</td>
                                        <td style="font-size: 0.75rem; color: #6b7280;">14 ‚â§ 22 ‚úì Cabe</td>
                                    </tr>
                                    <tr class="highlight-row">
                                        <td><strong>Urocultivo</strong></td>
                                        <td>25</td>
                                        <td>1</td>
                                        <td>40</td>
                                        <td>2</td>
                                        <td style="font-size: 0.75rem; color: #dc2626;"><strong>40 > 22 ‚úó Nueva p√°gina</strong></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-top: 2rem;">
                        <div class="metric-card">
                            <div style="font-size: 0.75rem; color: #6b7280; margin-bottom: 0.5rem; text-transform: uppercase;">L√≠neas Totales</div>
                            <div class="metric-value">37</div>
                        </div>
                        <div class="metric-card">
                            <div style="font-size: 0.75rem; color: #6b7280; margin-bottom: 0.5rem; text-transform: uppercase;">P√°ginas</div>
                            <div class="metric-value">2</div>
                        </div>
                        <div class="metric-card">
                            <div style="font-size: 0.75rem; color: #6b7280; margin-bottom: 0.5rem; text-transform: uppercase;">Eficiencia</div>
                            <div class="metric-value">84%</div>
                        </div>
                    </div>
                </div>

                <!-- FLECHA -->
                <div class="arrow-down">
                    <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <polyline points="19 12 12 19 5 12"></polyline>
                    </svg>
                </div>

                <!-- PASO 4: OUTPUT -->
                <div class="flow-box output">
                    <div class="step-number" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">4</div>
                    <h3 style="font-size: 1.5rem; font-weight: 700; color: #065f46; margin-bottom: 1.5rem;">
                        üìã PDF GENERADO (Datos + Referencias fusionadas)
                    </h3>

                    <div style="background: white; padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem;">
                        <h4 style="font-weight: 600; color: #374151; margin-bottom: 1rem;">P√°gina 1 (22 l√≠neas)</h4>
                        <div class="code-block">
<span style="color: #a78bfa;">LABORATORIO CL√çNICO CENTRAL</span>
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
Paciente: Ana Garc√≠a L√≥pez
DNI: 76543210 | Edad: 35 a√±os
Fecha: 15/11/2024

<span style="color: #fbbf24;">‚îÅ‚îÅ‚îÅ GLUCOSA ‚îÅ‚îÅ‚îÅ</span>
  Resultado: <span style="color: #10b981;">95 mg/
